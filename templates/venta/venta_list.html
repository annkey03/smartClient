{% extends 'base.html' %}

{% block title %}Ventas - SmartClient CRM{% endblock %}

{% block content %}
<div class="container py-5">

    <!-- Encabezado de página -->
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
        <h2 class="mb-0 d-flex align-items-center">
            <i class="fas fa-shopping-cart me-2 text-success"></i> 
            Mis Ventas
        </h2>
        <a href="{% url 'venta_create' %}" class="btn btn-success shadow-sm animate-btn">
            <i class="fas fa-plus me-1"></i> Nueva Venta
        </a>
    </div>

    <!-- Tarjeta contenedora -->
    <div class="card border-0 shadow-sm rounded-3 fade-in">
        <div class="card-body p-4">

            <!-- Tabla responsiva -->
            <div class="table-responsive">
                <table class="table align-middle table-hover text-center mb-0">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">Fecha</th>
                            <th scope="col">Cliente</th>
                            <th scope="col">Producto / Servicio</th>
                            <th scope="col">Monto</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for venta in ventas %}
                            <tr class="fade-row">
                                <td>{{ venta.fecha|date:"d/m/Y" }}</td>
                                <td>{{ venta.cliente.nombre }}</td>
                                <td class="text-start">{{ venta.producto_servicio|truncatechars:50 }}</td>
                                <td class="text-end fw-semibold">${{ venta.monto|floatformat:2 }}</td>
                                <td>
                                    <div class="d-flex justify-content-center gap-2">
                                        <a href="{% url 'venta_update' venta.pk %}" class="btn btn-sm btn-outline-primary hover-scale" title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'venta_delete' venta.pk %}" class="btn btn-sm btn-outline-danger hover-scale" title="Eliminar">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="5" class="text-center text-muted py-4">
                                    <i class="fas fa-info-circle me-2"></i>
                                    No tienes ventas registradas aún. 
                                    <a href="{% url 'venta_create' %}" class="text-decoration-none fw-semibold">Registrar la primera</a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

        </div>
    </div>

</div>

<style>
    /* Animación de entrada para la tarjeta */
    .fade-in {
        animation: fadeIn 0.6s ease-in-out;
    }

    /* Animación para las filas */
    .fade-row {
        opacity: 0;
        animation: fadeInRow 0.5s ease-in-out forwards;
    }

    .fade-row:nth-child(1) { animation-delay: 0.1s; }
    .fade-row:nth-child(2) { animation-delay: 0.2s; }
    .fade-row:nth-child(3) { animation-delay: 0.3s; }
    .fade-row:nth-child(4) { animation-delay: 0.4s; }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeInRow {
        from { opacity: 0; transform: translateY(5px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Efecto en botones */
    .hover-scale {
        transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .hover-scale:hover {
        transform: scale(1.1);
        box-shadow: 0 0 8px rgba(0,0,0,0.15);
    }

    .animate-btn {
        transition: all 0.2s ease;
    }

    .animate-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    /* Adaptación a modo oscuro */
    @media (prefers-color-scheme: dark) {
        .table-light {
            background-color: #222 !important;
            color: #ddd !important;
        }
        .card {
            background-color: #1e1e1e;
            color: #f5f5f5;
        }
        .text-muted {
            color: #aaa !important;
        }
        a.text-decoration-none.fw-semibold {
            color: #0dcaf0;
        }
    }
</style>
{% endblock %}
